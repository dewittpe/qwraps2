<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="qwraps2">
<title>Graphics in qwraps2 • qwraps2</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.2.2/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.2.2/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Graphics in qwraps2">
<meta property="og:description" content="qwraps2">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">qwraps2</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="Released version">0.6.0</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="active nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/qwraps2-data-sets.html">qwraps2 Data Sets</a>
    <a class="dropdown-item" href="../articles/qwraps2-graphics.html">Graphics in qwraps2</a>
    <a class="dropdown-item" href="../articles/summary-statistics.html">Formatted Summary Statistics and Data Summary Tables with qwraps2</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/dewittpe/qwraps2/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Graphics in qwraps2</h1>
                        <h4 data-toc-skip class="author">Peter
DeWitt</h4>
            
      
      <small class="dont-index">Source: <a href="https://github.com/dewittpe/qwraps2/blob/HEAD/vignettes/qwraps2-graphics.Rmd" class="external-link"><code>vignettes/qwraps2-graphics.Rmd</code></a></small>
      <div class="d-none name"><code>qwraps2-graphics.Rmd</code></div>
    </div>

    
    
<p>There are several graphics generated within qwraps2. The naming
convention for the “quick” plots was inspired by the (deprecated) <em><a href="https://cran.r-project.org/package=ggplot2" class="external-link">ggplot2</a></em>
function <code>qplot</code>. The development, flexibility, and
robustness of these functions vary. Some “tips and tricks” are
provided.</p>
<div class="section level2">
<h2 id="qacf-autocorrelation-plots">qacf: Autocorrelation Plots<a class="anchor" aria-label="anchor" href="#qacf-autocorrelation-plots"></a>
</h2>
<p>Generate an example data set.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">42</span><span class="op">)</span></span>
<span><span class="va">n</span> <span class="op">&lt;-</span> <span class="fl">250</span></span>
<span><span class="va">x1</span> <span class="op">&lt;-</span> <span class="va">x2</span> <span class="op">&lt;-</span> <span class="va">x3</span> <span class="op">&lt;-</span> <span class="va">x4</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/vector.html" class="external-link">vector</a></span><span class="op">(</span><span class="st">'numeric'</span>, length <span class="op">=</span> <span class="va">n</span><span class="op">)</span></span>
<span><span class="va">x1</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html" class="external-link">runif</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span></span>
<span><span class="va">x2</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html" class="external-link">runif</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span></span>
<span><span class="va">x3</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html" class="external-link">runif</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span></span>
<span><span class="va">x4</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html" class="external-link">runif</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># white noise</span></span>
<span><span class="va">Z.1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="va">n</span>, <span class="fl">0</span>, <span class="fl">1</span><span class="op">)</span></span>
<span><span class="va">Z.2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="va">n</span>, <span class="fl">0</span>, <span class="fl">2</span><span class="op">)</span></span>
<span><span class="va">Z.3</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="va">n</span>, <span class="fl">0</span>, <span class="fl">5</span><span class="op">)</span></span>
<span></span>
<span><span class="kw">for</span><span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">2</span><span class="op">:</span><span class="va">n</span><span class="op">)</span></span>
<span><span class="op">{</span></span>
<span>  <span class="va">x1</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">x1</span><span class="op">[</span><span class="va">i</span><span class="op">-</span><span class="fl">1</span><span class="op">]</span> <span class="op">+</span> <span class="va">Z.1</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">-</span> <span class="va">Z.1</span><span class="op">[</span><span class="va">i</span><span class="op">-</span><span class="fl">1</span><span class="op">]</span> <span class="op">+</span> <span class="va">x4</span><span class="op">[</span><span class="va">i</span><span class="op">-</span><span class="fl">1</span><span class="op">]</span> <span class="op">-</span> <span class="va">x2</span><span class="op">[</span><span class="va">i</span><span class="op">-</span><span class="fl">1</span><span class="op">]</span></span>
<span>  <span class="va">x2</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">x2</span><span class="op">[</span><span class="va">i</span><span class="op">-</span><span class="fl">1</span><span class="op">]</span> <span class="op">-</span> <span class="fl">2</span> <span class="op">*</span> <span class="va">Z.2</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">+</span> <span class="va">Z.2</span><span class="op">[</span><span class="va">i</span><span class="op">-</span><span class="fl">1</span><span class="op">]</span> <span class="op">-</span> <span class="va">x4</span><span class="op">[</span><span class="va">i</span><span class="op">-</span><span class="fl">1</span><span class="op">]</span></span>
<span>  <span class="va">x3</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">x3</span><span class="op">[</span><span class="va">i</span><span class="op">-</span><span class="fl">1</span><span class="op">]</span> <span class="op">+</span> <span class="va">x2</span><span class="op">[</span><span class="va">i</span><span class="op">-</span><span class="fl">1</span><span class="op">]</span> <span class="op">+</span> <span class="fl">0.2</span> <span class="op">*</span> <span class="va">Z.3</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">+</span> <span class="va">Z.3</span><span class="op">[</span><span class="va">i</span><span class="op">-</span><span class="fl">1</span><span class="op">]</span></span>
<span>  <span class="va">x4</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">x4</span><span class="op">[</span><span class="va">i</span><span class="op">-</span><span class="fl">1</span><span class="op">]</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html" class="external-link">runif</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">0.5</span>, <span class="fl">1.5</span><span class="op">)</span> <span class="op">*</span> <span class="va">x4</span><span class="op">[</span><span class="va">i</span><span class="op">-</span><span class="fl">1</span><span class="op">]</span></span>
<span><span class="op">}</span></span>
<span><span class="va">testdf</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span><span class="va">x1</span>, <span class="va">x2</span>, <span class="va">x3</span>, <span class="va">x4</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Base acf plot for one variable</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/acf.html" class="external-link">acf</a></span><span class="op">(</span><span class="va">testdf</span><span class="op">$</span><span class="va">x1</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># qacf plot for one variable</span></span>
<span><span class="fu"><a href="../reference/qacf.html">qacf</a></span><span class="op">(</span><span class="va">testdf</span><span class="op">$</span><span class="va">x1</span><span class="op">)</span></span></code></pre></div>
<p><img src="qwraps2-graphics_files/figure-html/unnamed-chunk-1-1.png" width="700"><img src="qwraps2-graphics_files/figure-html/unnamed-chunk-1-2.png" width="700"></p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/qacf.html">qacf</a></span><span class="op">(</span><span class="va">testdf</span><span class="op">$</span><span class="va">x1</span>, show_sig <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<p><img src="qwraps2-graphics_files/figure-html/unnamed-chunk-1-3.png" width="700"></p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># more than one variable</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/acf.html" class="external-link">acf</a></span><span class="op">(</span><span class="va">testdf</span><span class="op">)</span></span></code></pre></div>
<p><img src="qwraps2-graphics_files/figure-html/unnamed-chunk-2-1.png" width="480"></p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/qacf.html">qacf</a></span><span class="op">(</span><span class="va">testdf</span><span class="op">)</span></span></code></pre></div>
<p><img src="qwraps2-graphics_files/figure-html/unnamed-chunk-2-2.png" width="480"></p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/qacf.html">qacf</a></span><span class="op">(</span><span class="va">testdf</span>, show_sig <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<p><img src="qwraps2-graphics_files/figure-html/unnamed-chunk-2-3.png" width="480"></p>
<div class="section level3">
<h3 id="tips-and-tricks">Tips and tricks<a class="anchor" aria-label="anchor" href="#tips-and-tricks"></a>
</h3>
<p>The implementation of qacf is based on the use of
<code><a href="https://rdrr.io/r/stats/acf.html" class="external-link">stats::acf</a></code> to produce the statistics needed for the plot.
If you want to get at the data itself to build your own acf plot you can
extract the data frame from the qacf return:</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">acf_plot_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/qacf.html">qacf</a></span><span class="op">(</span><span class="va">testdf</span><span class="op">)</span><span class="op">$</span><span class="va">data</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">acf_plot_data</span><span class="op">)</span></span>
<span><span class="co">##   lag variable      value significant facets</span></span>
<span><span class="co">## 1   0       V1 1.00000000        TRUE     x1</span></span>
<span><span class="co">## 2   1       V1 0.53067306        TRUE     x1</span></span>
<span><span class="co">## 3   2       V1 0.28669463        TRUE     x1</span></span>
<span><span class="co">## 4   3       V1 0.15161298        TRUE     x1</span></span>
<span><span class="co">## 5   4       V1 0.08015682       FALSE     x1</span></span>
<span><span class="co">## 6   5       V1 0.04355315       FALSE     x1</span></span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="qblandaltman-bland-altman-plot">qblandaltman: Bland Altman Plot<a class="anchor" aria-label="anchor" href="#qblandaltman-bland-altman-plot"></a>
</h2>
<p>Introduced in <span class="citation">[@altman1983measurement]</span>
and <span class="citation">[@bland1986statistical]</span>, the
qblandaltman method builds ggplot2 style Bland Altman plots. For
examples we use the provided pefr data set which was transcribed from
<span class="citation">[@bland1986statistical]</span>. See
<code><a href="../articles/qwraps2-data-sets.html">vignette("qwraps2-data-sets", package = "qwraps2")</a></code> For more
details on that data set.</p>
<p>The following replicates the figures in <span class="citation">[@bland1986statistical]</span>.</p>
<p>Using the first measurement only:</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">pefr_m1</span> <span class="op">&lt;-</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="st">"Large"</span> <span class="op">=</span> <span class="va">pefr</span><span class="op">[</span><span class="va">pefr</span><span class="op">$</span><span class="va">measurement</span> <span class="op">==</span> <span class="fl">1</span> <span class="op">&amp;</span> <span class="va">pefr</span><span class="op">$</span><span class="va">meter</span> <span class="op">==</span> <span class="st">"Wright peak flow meter"</span>, <span class="st">"pefr"</span><span class="op">]</span>,</span>
<span>        <span class="st">"Mini"</span>  <span class="op">=</span> <span class="va">pefr</span><span class="op">[</span><span class="va">pefr</span><span class="op">$</span><span class="va">measurement</span> <span class="op">==</span> <span class="fl">1</span> <span class="op">&amp;</span> <span class="va">pefr</span><span class="op">$</span><span class="va">meter</span> <span class="op">==</span> <span class="st">"Mini Wright peak flow meter"</span>, <span class="st">"pefr"</span><span class="op">]</span><span class="op">)</span></span></code></pre></div>
<p>A standard x-y style plot and a correlation coefficient suggests that
the two meters provide reasonably similar results.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/cor.html" class="external-link">cor</a></span><span class="op">(</span><span class="va">pefr_m1</span><span class="op">)</span></span>
<span><span class="co">##           Large      Mini</span></span>
<span><span class="co">## Large 1.0000000 0.9432794</span></span>
<span><span class="co">## Mini  0.9432794 1.0000000</span></span>
<span></span>
<span><span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span>data <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html" class="external-link">as.data.frame</a></span><span class="op">(</span><span class="va">pefr_m1</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">Large</span>, y <span class="op">=</span> <span class="va">Mini</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">xlab</a></span><span class="op">(</span><span class="st">"Large Meter"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ylab</a></span><span class="op">(</span><span class="st">"Mini Meter"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/lims.html" class="external-link">xlim</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">800</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/lims.html" class="external-link">ylim</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">800</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html" class="external-link">geom_abline</a></span><span class="op">(</span>slope <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span></code></pre></div>
<p><img src="qwraps2-graphics_files/figure-html/unnamed-chunk-5-1.png" width="700"></p>
<p>However, for many reasons, the above is misleading. One simple note:
correlation is not a metric for agreement, i.e., perfect agreement would
be shown if all the data points fell on the line of equality whereas
perfect correlation occurs when the data points are simply
co-linear.</p>
<p>The Bland Altman plot plots the average value on the x-axis and the
difference in the measurements on the y-axis:</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># default plot</span></span>
<span><span class="fu"><a href="../reference/qblandaltman.html">qblandaltman</a></span><span class="op">(</span><span class="va">pefr_m1</span><span class="op">)</span></span></code></pre></div>
<p><img src="qwraps2-graphics_files/figure-html/unnamed-chunk-6-1.png" width="700"></p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="co"># modified plot</span></span>
<span><span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/last_plot.html" class="external-link">last_plot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/lims.html" class="external-link">xlim</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">800</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/lims.html" class="external-link">ylim</a></span><span class="op">(</span><span class="op">-</span><span class="fl">100</span>, <span class="fl">100</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">xlab</a></span><span class="op">(</span><span class="st">"Average of two meters"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ylab</a></span><span class="op">(</span><span class="st">"Difference in the measurements"</span><span class="op">)</span></span></code></pre></div>
<p><img src="qwraps2-graphics_files/figure-html/unnamed-chunk-6-2.png" width="700"></p>
<p>There is no distinct relationship between the differences and the
average, but the difference in the measurements between the two meters
was observed to range between -73 and 81 liters per minute. Such a
discrepancy between the meters is not observable from the simple x-y
plot.</p>
<p>Reliability, or repeatability, of measurements can also be
investigated with a Bland Altman plot.</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">pefr_mini</span> <span class="op">&lt;-</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span>m1 <span class="op">=</span> <span class="va">pefr</span><span class="op">[</span><span class="va">pefr</span><span class="op">$</span><span class="va">measurement</span> <span class="op">==</span> <span class="fl">1</span> <span class="op">&amp;</span> <span class="va">pefr</span><span class="op">$</span><span class="va">meter</span> <span class="op">==</span> <span class="st">"Mini Wright peak flow meter"</span>, <span class="st">"pefr"</span><span class="op">]</span>,</span>
<span>        m2 <span class="op">=</span> <span class="va">pefr</span><span class="op">[</span><span class="va">pefr</span><span class="op">$</span><span class="va">measurement</span> <span class="op">==</span> <span class="fl">2</span> <span class="op">&amp;</span> <span class="va">pefr</span><span class="op">$</span><span class="va">meter</span> <span class="op">==</span> <span class="st">"Mini Wright peak flow meter"</span>, <span class="st">"pefr"</span><span class="op">]</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="../reference/qblandaltman.html">qblandaltman</a></span><span class="op">(</span><span class="va">pefr_mini</span><span class="op">)</span></span></code></pre></div>
<p><img src="qwraps2-graphics_files/figure-html/unnamed-chunk-7-1.png" width="700"></p>
</div>
<div class="section level2">
<h2 id="qkmplot-kaplan-meier-plots">qkmplot: Kaplan Meier Plots<a class="anchor" aria-label="anchor" href="#qkmplot-kaplan-meier-plots"></a>
</h2>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># create a survfit object</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">require</a></span><span class="op">(</span><span class="va"><a href="https://github.com/therneau/survival" class="external-link">survival</a></span><span class="op">)</span></span>
<span><span class="co">## Loading required package: survival</span></span>
<span><span class="va">leukemia.surv</span> <span class="op">&lt;-</span> <span class="fu">survival</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/survival/man/survfit.html" class="external-link">survfit</a></span><span class="op">(</span><span class="fu">survival</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/survival/man/Surv.html" class="external-link">Surv</a></span><span class="op">(</span><span class="va">time</span>, <span class="va">status</span><span class="op">)</span> <span class="op">~</span> <span class="va">x</span>, data <span class="op">=</span> <span class="fu">survival</span><span class="fu">::</span><span class="va"><a href="https://rdrr.io/pkg/survival/man/aml.html" class="external-link">aml</a></span><span class="op">)</span></span>
<span></span>
<span><span class="co"># base R km plot</span></span>
<span><span class="fu">survival</span><span class="fu">:::</span><span class="fu"><a href="https://rdrr.io/pkg/survival/man/plot.survfit.html" class="external-link">plot.survfit</a></span><span class="op">(</span><span class="va">leukemia.surv</span>, conf.int <span class="op">=</span> <span class="cn">TRUE</span>, lty <span class="op">=</span> <span class="fl">2</span><span class="op">:</span><span class="fl">3</span>, col <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">2</span><span class="op">)</span></span></code></pre></div>
<p><img src="qwraps2-graphics_files/figure-html/unnamed-chunk-8-1.png" width="700"></p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># qkmplot</span></span>
<span><span class="fu"><a href="../reference/qkmplot.html">qkmplot</a></span><span class="op">(</span><span class="va">leukemia.surv</span>, conf_int <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="co">## Warning: Removed 1 rows containing non-finite values</span></span>
<span><span class="co">## (`stat_step_ribbon()`).</span></span></code></pre></div>
<p><img src="qwraps2-graphics_files/figure-html/unnamed-chunk-9-1.png" width="480"></p>
<p>The function <code>qkmplot_bulid_data_frame</code> can be used to
generate a data.frame needed for building a KM plot. This could be
helpful for creating bespoke plots.</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">leukemia_km_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/qkmplot.html">qkmplot_bulid_data_frame</a></span><span class="op">(</span><span class="va">leukemia.surv</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">leukemia_km_data</span>, <span class="fl">3</span><span class="op">)</span></span>
<span><span class="co">##   time n.risk n.event n.censor      surv upper     lower       strata</span></span>
<span><span class="co">## 2    0     11       0        0 1.0000000     1 1.0000000 x=Maintained</span></span>
<span><span class="co">## 3    9     11       1        0 0.9090909     1 0.7541338 x=Maintained</span></span>
<span><span class="co">## 4   13     10       1        1 0.8181818     1 0.6192490 x=Maintained</span></span></code></pre></div>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/qkmplot.html">qkmplot</a></span><span class="op">(</span><span class="va">leukemia_km_data</span><span class="op">)</span></span></code></pre></div>
<p><img src="qwraps2-graphics_files/figure-html/unnamed-chunk-11-1.png" width="480"></p>
<p>Intercept only models are easy to plot too.</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">intonly_fit</span> <span class="op">&lt;-</span> <span class="fu">survival</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/survival/man/survfit.html" class="external-link">survfit</a></span><span class="op">(</span><span class="fu">survival</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/survival/man/Surv.html" class="external-link">Surv</a></span><span class="op">(</span><span class="va">time</span>, <span class="va">status</span><span class="op">)</span> <span class="op">~</span> <span class="fl">1</span>, data <span class="op">=</span> <span class="fu">survival</span><span class="fu">::</span><span class="va"><a href="https://rdrr.io/pkg/survival/man/aml.html" class="external-link">aml</a></span><span class="op">)</span></span>
<span><span class="fu">survival</span><span class="fu">:::</span><span class="fu"><a href="https://rdrr.io/pkg/survival/man/plot.survfit.html" class="external-link">plot.survfit</a></span><span class="op">(</span><span class="va">intonly_fit</span>, conf.int <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<p><img src="qwraps2-graphics_files/figure-html/unnamed-chunk-12-1.png" width="480"></p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/qkmplot.html">qkmplot</a></span><span class="op">(</span><span class="va">intonly_fit</span>, conf_int <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<p><img src="qwraps2-graphics_files/figure-html/unnamed-chunk-12-2.png" width="480"></p>
</div>
<div class="section level2">
<h2 id="qroc-and-qprc-receiver-operating-curve-and-precision-recall-curve">qroc and qprc: Receiver Operating Curve and Precision Recall
Curve<a class="anchor" aria-label="anchor" href="#qroc-and-qprc-receiver-operating-curve-and-precision-recall-curve"></a>
</h2>
<p>Starting in <em>qwraps2</em> version 0.6.0, the methods for building
these graphics have been fundamentally changed as part of a major
refactor of the <code>confusion_matrix</code> method which replaces a
lot of the code that <code>qroc</code> and <code>qprc</code> were built
on.</p>
<p>Let’s start with an example of having two models for predicing if the
price of a diamond exceeds $2,800.</p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">diamonds</span>, package <span class="op">=</span> <span class="st">"ggplot2"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Create two logistic regression models</span></span>
<span><span class="va">fit1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/glm.html" class="external-link">glm</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/AsIs.html" class="external-link">I</a></span><span class="op">(</span><span class="va">price</span> <span class="op">&gt;</span> <span class="fl">2800</span><span class="op">)</span> <span class="op">~</span> <span class="va">cut</span> <span class="op">*</span> <span class="va">color</span>, data <span class="op">=</span> <span class="va">diamonds</span>, family <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/family.html" class="external-link">binomial</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">fit2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/glm.html" class="external-link">glm</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/AsIs.html" class="external-link">I</a></span><span class="op">(</span><span class="va">price</span> <span class="op">&gt;</span> <span class="fl">2800</span><span class="op">)</span> <span class="op">~</span> <span class="va">cut</span> <span class="op">+</span> <span class="va">color</span> <span class="op">+</span> <span class="va">clarity</span>, data <span class="op">=</span> <span class="va">diamonds</span>, family <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/family.html" class="external-link">binomial</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p>To build ROC and/or PRC plots start by building the confusion matrix
for each</p>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">cm1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/confusion_matrix.html">confusion_matrix</a></span><span class="op">(</span>truth <span class="op">=</span> <span class="va">diamonds</span><span class="op">$</span><span class="va">price</span> <span class="op">&gt;</span> <span class="fl">2800</span>, predicted <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict</a></span><span class="op">(</span><span class="va">fit1</span>, type <span class="op">=</span> <span class="st">"response"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">cm2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/confusion_matrix.html">confusion_matrix</a></span><span class="op">(</span>truth <span class="op">=</span> <span class="va">diamonds</span><span class="op">$</span><span class="va">price</span> <span class="op">&gt;</span> <span class="fl">2800</span>, predicted <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict</a></span><span class="op">(</span><span class="va">fit2</span>, type <span class="op">=</span> <span class="st">"response"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p>Calling <code>confusion_matrix</code> will generate list object with
the need plotting data and other results.</p>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/str.html" class="external-link">str</a></span><span class="op">(</span><span class="va">cm1</span><span class="op">)</span></span>
<span><span class="co">## List of 8</span></span>
<span><span class="co">##  $ cm_stats      :'data.frame':  38 obs. of  23 variables:</span></span>
<span><span class="co">##   ..$ threshold      : num [1:38] -Inf 0.275 0.275 0.277 0.35 ...</span></span>
<span><span class="co">##   ..$ TP             : int [1:38] 24705 24705 23632 23632 22848 21507 19647 18693 17752 17062 ...</span></span>
<span><span class="co">##   ..$ TN             : int [1:38] 0 0 2829 2830 4880 7365 10389 11835 13231 14144 ...</span></span>
<span><span class="co">##   ..$ FP             : int [1:38] 29235 29235 26406 26405 24355 21870 18846 17400 16004 15091 ...</span></span>
<span><span class="co">##   ..$ FN             : int [1:38] 0 0 1073 1073 1857 3198 5058 6012 6953 7643 ...</span></span>
<span><span class="co">##   ..$ sensitivity    : num [1:38] 1 1 0.957 0.957 0.925 ...</span></span>
<span><span class="co">##   ..$ sensitivity_lcl: num [1:38] NaN NaN 0.954 0.954 0.921 ...</span></span>
<span><span class="co">##   ..$ sensitivity_ucl: num [1:38] 1 1 0.959 0.959 0.928 ...</span></span>
<span><span class="co">##   ..$ specificity    : num [1:38] 0 0 0.0968 0.0968 0.1669 ...</span></span>
<span><span class="co">##   ..$ specificity_lcl: num [1:38] 0 0 0.0934 0.0935 0.1627 ...</span></span>
<span><span class="co">##   ..$ specificity_ucl: num [1:38] NaN NaN 0.1 0.1 0.171 ...</span></span>
<span><span class="co">##   ..$ ppv            : num [1:38] 0.458 0.458 0.472 0.472 0.484 ...</span></span>
<span><span class="co">##   ..$ ppv_lcl        : num [1:38] 0.454 0.454 0.468 0.468 0.48 ...</span></span>
<span><span class="co">##   ..$ ppv_ucl        : num [1:38] 0.462 0.462 0.477 0.477 0.489 ...</span></span>
<span><span class="co">##   ..$ npv            : num [1:38] NaN NaN 0.725 0.725 0.724 ...</span></span>
<span><span class="co">##   ..$ npv_lcl        : num [1:38] NaN NaN 0.711 0.711 0.714 ...</span></span>
<span><span class="co">##   ..$ npv_ucl        : num [1:38] NaN NaN 0.739 0.739 0.735 ...</span></span>
<span><span class="co">##   ..$ accuracy       : num [1:38] 0.458 0.458 0.491 0.491 0.514 ...</span></span>
<span><span class="co">##   ..$ accuracy_lcl   : num [1:38] 0.454 0.454 0.486 0.486 0.51 ...</span></span>
<span><span class="co">##   ..$ accuracy_ucl   : num [1:38] 0.462 0.462 0.495 0.495 0.518 ...</span></span>
<span><span class="co">##   ..$ youden         : num [1:38] 0 0 0.0533 0.0534 0.0918 ...</span></span>
<span><span class="co">##   ..$ mcc            : num [1:38] NA NA 0.103 0.103 0.138 ...</span></span>
<span><span class="co">##   ..$ f1             : num [1:38] 0.628 0.628 0.632 0.632 0.635 ...</span></span>
<span><span class="co">##  $ auroc         : num 0.627</span></span>
<span><span class="co">##  $ auroc_ci      : num [1:2] 0.623 0.631</span></span>
<span><span class="co">##  $ auprc         : num 0.567</span></span>
<span><span class="co">##  $ auprc_ci      : num [1:2] 0.563 0.572</span></span>
<span><span class="co">##  $ confint_method: chr "logit"</span></span>
<span><span class="co">##  $ alpha         : num 0.05</span></span>
<span><span class="co">##  $ prevalence    : num 0.458</span></span>
<span><span class="co">##  - attr(*, "class")= chr "qwraps2_confusion_matrix"</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/str.html" class="external-link">str</a></span><span class="op">(</span><span class="va">cm2</span><span class="op">)</span></span>
<span><span class="co">## List of 8</span></span>
<span><span class="co">##  $ cm_stats      :'data.frame':  279 obs. of  23 variables:</span></span>
<span><span class="co">##   ..$ threshold      : num [1:279] -Inf 0.122 0.122 0.122 0.125 ...</span></span>
<span><span class="co">##   ..$ TP             : int [1:279] 24705 24705 24705 24652 24638 24594 24574 24543 24524 24518 ...</span></span>
<span><span class="co">##   ..$ TN             : int [1:279] 0 0 1 282 347 447 455 594 618 655 ...</span></span>
<span><span class="co">##   ..$ FP             : int [1:279] 29235 29235 29234 28953 28888 28788 28780 28641 28617 28580 ...</span></span>
<span><span class="co">##   ..$ FN             : int [1:279] 0 0 0 53 67 111 131 162 181 187 ...</span></span>
<span><span class="co">##   ..$ sensitivity    : num [1:279] 1 1 1 0.998 0.997 ...</span></span>
<span><span class="co">##   ..$ sensitivity_lcl: num [1:279] NaN NaN NaN 0.997 0.997 ...</span></span>
<span><span class="co">##   ..$ sensitivity_ucl: num [1:279] 1 1 1 0.998 0.998 ...</span></span>
<span><span class="co">##   ..$ specificity    : num [1:279] 0.00 0.00 3.42e-05 9.65e-03 1.19e-02 ...</span></span>
<span><span class="co">##   ..$ specificity_lcl: num [1:279] 0.00 0.00 4.82e-06 8.59e-03 1.07e-02 ...</span></span>
<span><span class="co">##   ..$ specificity_ucl: num [1:279] NaN NaN 0.000243 0.010833 0.013177 ...</span></span>
<span><span class="co">##   ..$ ppv            : num [1:279] 0.458 0.458 0.458 0.46 0.46 ...</span></span>
<span><span class="co">##   ..$ ppv_lcl        : num [1:279] 0.454 0.454 0.454 0.456 0.456 ...</span></span>
<span><span class="co">##   ..$ ppv_ucl        : num [1:279] 0.462 0.462 0.462 0.464 0.465 ...</span></span>
<span><span class="co">##   ..$ npv            : num [1:279] NaN NaN 1 0.842 0.838 ...</span></span>
<span><span class="co">##   ..$ npv_lcl        : num [1:279] NaN NaN NaN 0.799 0.799 ...</span></span>
<span><span class="co">##   ..$ npv_ucl        : num [1:279] NaN NaN 1 0.877 0.871 ...</span></span>
<span><span class="co">##   ..$ accuracy       : num [1:279] 0.458 0.458 0.458 0.462 0.463 ...</span></span>
<span><span class="co">##   ..$ accuracy_lcl   : num [1:279] 0.454 0.454 0.454 0.458 0.459 ...</span></span>
<span><span class="co">##   ..$ accuracy_ucl   : num [1:279] 0.462 0.462 0.462 0.466 0.467 ...</span></span>
<span><span class="co">##   ..$ youden         : num [1:279] 0.00 0.00 3.42e-05 7.50e-03 9.16e-03 ...</span></span>
<span><span class="co">##   ..$ mcc            : num [1:279] NA NA 0.00396 0.04757 0.05228 ...</span></span>
<span><span class="co">##   ..$ f1             : num [1:279] 0.628 0.628 0.628 0.63 0.63 ...</span></span>
<span><span class="co">##  $ auroc         : num 0.689</span></span>
<span><span class="co">##  $ auroc_ci      : num [1:2] 0.685 0.693</span></span>
<span><span class="co">##  $ auprc         : num 0.645</span></span>
<span><span class="co">##  $ auprc_ci      : num [1:2] 0.641 0.649</span></span>
<span><span class="co">##  $ confint_method: chr "logit"</span></span>
<span><span class="co">##  $ alpha         : num 0.05</span></span>
<span><span class="co">##  $ prevalence    : num 0.458</span></span>
<span><span class="co">##  - attr(*, "class")= chr "qwraps2_confusion_matrix"</span></span></code></pre></div>
<p>Plotting ROC can be done by calling <code>qroc</code></p>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/qroc-qprc.html">qroc</a></span><span class="op">(</span><span class="va">cm2</span><span class="op">)</span></span></code></pre></div>
<p><img src="qwraps2-graphics_files/figure-html/unnamed-chunk-16-1.png" width="700"></p>
<p>The plots generated a ggplot2 plots and can be modified like any
other ggplot2 plot, for example</p>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Add the AUC value to the plot title</span></span>
<span><span class="fu"><a href="../reference/qroc-qprc.html">qroc</a></span><span class="op">(</span><span class="va">cm2</span><span class="op">)</span> <span class="op">+</span> <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ggtitle</a></span><span class="op">(</span>label <span class="op">=</span> <span class="st">"Fit 2"</span>, subtitle <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="st">"AUROC ="</span>, <span class="fu"><a href="../reference/frmt.html">frmt</a></span><span class="op">(</span><span class="va">cm2</span><span class="op">$</span><span class="va">auroc</span>, digits <span class="op">=</span> <span class="fl">3</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="qwraps2-graphics_files/figure-html/unnamed-chunk-17-1.png" width="700"></p>
<p>You can also use the results to build up a data set for plotting
multiple curves together.</p>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">plot_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">rbind</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span>Model <span class="op">=</span> <span class="st">"fit1"</span>, <span class="va">cm1</span><span class="op">$</span><span class="va">cm_stats</span><span class="op">)</span>,</span>
<span>                   <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span>Model <span class="op">=</span> <span class="st">"fit2"</span>, <span class="va">cm2</span><span class="op">$</span><span class="va">cm_stats</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/qroc-qprc.html">qroc</a></span><span class="op">(</span><span class="va">plot_data</span><span class="op">)</span> <span class="op">+</span> <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>color <span class="op">=</span> <span class="va">Model</span><span class="op">)</span></span></code></pre></div>
<p><img src="qwraps2-graphics_files/figure-html/unnamed-chunk-18-1.png" width="700"></p>
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="co"># with AUC in the legend</span></span>
<span><span class="va">plot_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">rbind</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span>Model <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="st">"Fit1\nAUROC ="</span>, <span class="fu"><a href="../reference/frmt.html">frmt</a></span><span class="op">(</span><span class="va">cm1</span><span class="op">$</span><span class="va">auroc</span>, <span class="fl">3</span><span class="op">)</span><span class="op">)</span>, <span class="va">cm1</span><span class="op">$</span><span class="va">cm_stats</span><span class="op">)</span>,</span>
<span>                   <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span>Model <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="st">"Fit2\nAUROC ="</span>, <span class="fu"><a href="../reference/frmt.html">frmt</a></span><span class="op">(</span><span class="va">cm2</span><span class="op">$</span><span class="va">auroc</span>, <span class="fl">3</span><span class="op">)</span><span class="op">)</span>, <span class="va">cm2</span><span class="op">$</span><span class="va">cm_stats</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/qroc-qprc.html">qroc</a></span><span class="op">(</span><span class="va">plot_data</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_bw</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>color <span class="op">=</span> <span class="va">Model</span>, linetype <span class="op">=</span> <span class="va">Model</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>legend.position   <span class="op">=</span> <span class="st">"bottom"</span>,</span>
<span>                 legend.text.align <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span></span></code></pre></div>
<p><img src="qwraps2-graphics_files/figure-html/unnamed-chunk-18-2.png" width="700"></p>
<p>Building PRC plots is similar, just use prc insead of roc in all the
above calls.</p>
<div class="sourceCode" id="cb25"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/qroc-qprc.html">qprc</a></span><span class="op">(</span><span class="va">cm1</span><span class="op">)</span></span></code></pre></div>
<p><img src="qwraps2-graphics_files/figure-html/unnamed-chunk-19-1.png" width="700"></p>
<div class="sourceCode" id="cb26"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/qroc-qprc.html">qprc</a></span><span class="op">(</span><span class="va">cm2</span><span class="op">)</span> <span class="op">+</span> <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ggtitle</a></span><span class="op">(</span>label <span class="op">=</span> <span class="st">"Fit 2"</span>, subtitle <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="st">"AUPRC ="</span>, <span class="fu"><a href="../reference/frmt.html">frmt</a></span><span class="op">(</span><span class="va">cm2</span><span class="op">$</span><span class="va">auprc</span>, digits <span class="op">=</span> <span class="fl">3</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="qwraps2-graphics_files/figure-html/unnamed-chunk-19-2.png" width="700"></p>
<div class="sourceCode" id="cb27"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/qroc-qprc.html">qprc</a></span><span class="op">(</span><span class="va">plot_data</span><span class="op">)</span> <span class="op">+</span> <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>color <span class="op">=</span> <span class="va">Model</span><span class="op">)</span></span></code></pre></div>
<p><img src="qwraps2-graphics_files/figure-html/unnamed-chunk-19-3.png" width="700"></p>
<p>One caveat for plotting multiple PRC on one plot is that you’ll need
to specify the prevalence value to plot.</p>
<div class="sourceCode" id="cb28"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">plot_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">rbind</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span>Model <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="st">"Fit1\nAUPRC ="</span>, <span class="fu"><a href="../reference/frmt.html">frmt</a></span><span class="op">(</span><span class="va">cm1</span><span class="op">$</span><span class="va">auprc</span>, <span class="fl">3</span><span class="op">)</span><span class="op">)</span>, <span class="va">cm1</span><span class="op">$</span><span class="va">cm_stats</span><span class="op">)</span>,</span>
<span>                   <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span>Model <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="st">"Fit2\nAUPRC ="</span>, <span class="fu"><a href="../reference/frmt.html">frmt</a></span><span class="op">(</span><span class="va">cm2</span><span class="op">$</span><span class="va">auprc</span>, <span class="fl">3</span><span class="op">)</span><span class="op">)</span>, <span class="va">cm2</span><span class="op">$</span><span class="va">cm_stats</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="../reference/qroc-qprc.html">qprc</a></span><span class="op">(</span><span class="va">plot_data</span>, prevalence <span class="op">=</span> <span class="va">cm1</span><span class="op">$</span><span class="va">prevalence</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_bw</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>color <span class="op">=</span> <span class="va">Model</span>, linetype <span class="op">=</span> <span class="va">Model</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>legend.position   <span class="op">=</span> <span class="st">"bottom"</span>,</span>
<span>                 legend.text.align <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span></span></code></pre></div>
<p><img src="qwraps2-graphics_files/figure-html/unnamed-chunk-20-1.png" width="700"></p>
</div>
<div class="section level2">
<h2 id="session-info">Session Info<a class="anchor" aria-label="anchor" href="#session-info"></a>
</h2>
<div class="sourceCode" id="cb29"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/sessionInfo.html" class="external-link">sessionInfo</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">## R version 4.3.2 (2023-10-31)</span></span>
<span><span class="co">## Platform: x86_64-pc-linux-gnu (64-bit)</span></span>
<span><span class="co">## Running under: Ubuntu 22.04.3 LTS</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Matrix products: default</span></span>
<span><span class="co">## BLAS:   /usr/lib/x86_64-linux-gnu/openblas-pthread/libblas.so.3 </span></span>
<span><span class="co">## LAPACK: /usr/lib/x86_64-linux-gnu/openblas-pthread/libopenblasp-r0.3.20.so;  LAPACK version 3.10.0</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## locale:</span></span>
<span><span class="co">##  [1] LC_CTYPE=C.UTF-8       LC_NUMERIC=C           LC_TIME=C.UTF-8       </span></span>
<span><span class="co">##  [4] LC_COLLATE=C.UTF-8     LC_MONETARY=C.UTF-8    LC_MESSAGES=C.UTF-8   </span></span>
<span><span class="co">##  [7] LC_PAPER=C.UTF-8       LC_NAME=C              LC_ADDRESS=C          </span></span>
<span><span class="co">## [10] LC_TELEPHONE=C         LC_MEASUREMENT=C.UTF-8 LC_IDENTIFICATION=C   </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## time zone: UTC</span></span>
<span><span class="co">## tzcode source: system (glibc)</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## attached base packages:</span></span>
<span><span class="co">## [1] stats     graphics  grDevices utils     datasets  methods   base     </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## other attached packages:</span></span>
<span><span class="co">## [1] survival_3.5-7 qwraps2_0.6.0 </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## loaded via a namespace (and not attached):</span></span>
<span><span class="co">##  [1] sass_0.4.7        utf8_1.2.4        generics_0.1.3    stringi_1.7.12   </span></span>
<span><span class="co">##  [5] lattice_0.21-9    digest_0.6.33     magrittr_2.0.3    evaluate_0.23    </span></span>
<span><span class="co">##  [9] grid_4.3.2        fastmap_1.1.1     rprojroot_2.0.3   jsonlite_1.8.7   </span></span>
<span><span class="co">## [13] Matrix_1.6-1.1    purrr_1.0.2       fansi_1.0.5       scales_1.2.1     </span></span>
<span><span class="co">## [17] textshaping_0.3.7 jquerylib_0.1.4   cli_3.6.1         rlang_1.1.1      </span></span>
<span><span class="co">## [21] munsell_0.5.0     splines_4.3.2     withr_2.5.2       cachem_1.0.8     </span></span>
<span><span class="co">## [25] yaml_2.3.7        tools_4.3.2       memoise_2.0.1     dplyr_1.1.3      </span></span>
<span><span class="co">## [29] colorspace_2.1-0  ggplot2_3.4.4     vctrs_0.6.4       R6_2.5.1         </span></span>
<span><span class="co">## [33] lifecycle_1.0.3   stringr_1.5.0     fs_1.6.3          ragg_1.2.6       </span></span>
<span><span class="co">## [37] pkgconfig_2.0.3   desc_1.4.2        pkgdown_2.0.7     pillar_1.9.0     </span></span>
<span><span class="co">## [41] bslib_0.5.1       gtable_0.3.4      glue_1.6.2        Rcpp_1.0.11      </span></span>
<span><span class="co">## [45] systemfonts_1.0.5 xfun_0.41         tibble_3.2.1      tidyselect_1.2.0 </span></span>
<span><span class="co">## [49] highr_0.10        knitr_1.45        farver_2.1.1      htmltools_0.5.6.1</span></span>
<span><span class="co">## [53] rmarkdown_2.25    labeling_0.4.3    compiler_4.3.2</span></span></code></pre></div>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by Peter DeWitt.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
